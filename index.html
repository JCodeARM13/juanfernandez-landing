<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Protocolo VIERNES - Acceso Restringido</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #000;
      color: #f5f5f7;
      overflow: hidden;
    }
    .fade-in { animation: fadeIn 1s ease-in-out forwards; }
    .fade-out { animation: fadeOut 1s ease-in-out forwards; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; display: none; } }

    /* Estilos para la intro "Matrix" y "Glitch" */
    #matrix-screen, #glitch-screen {
        font-family: 'Roboto Mono', monospace;
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        background: #000;
    }
    #matrix-screen { z-index: 40; }
    #glitch-screen { z-index: 30; }

    #matrix-text { white-space: pre-wrap; }
    .blinking-cursor { animation: blink 1s step-end infinite; }
    @keyframes blink { 50% { border-right-color: #00ff41; } }

    #glitch-container {
        padding: 1rem;
        word-wrap: break-word;
        white-space: pre-wrap;
        font-size: 0.8rem;
        line-height: 1.4;
        opacity: 0.7;
    }
    .glitch-char { display: inline-block; animation: glitch-anim 1.5s infinite; }
    @keyframes glitch-anim {
        0%, 100% { text-shadow: none; opacity: 1; }
        25% { text-shadow: -2px 0 #ff00c1, 2px 0 #00fff3; opacity: 0.8; }
        50% { text-shadow: 2px 0 #ff00c1, -2px 0 #00fff3; opacity: 1; }
        75% { text-shadow: -1px 0 #ff00c1, 1px 0 #00fff3; opacity: 0.8; }
    }
    .color-1 { color: #ff00c1; } /* Magenta */
    .color-2 { color: #00fff3; } /* Cyan */
    .color-3 { color: #f0db4f; } /* Yellow */
    
    /* Estilos para el chat rediseñado */
    #chat-container {
        background: url('https://www.transparenttextures.com/patterns/dark-matter.png'), #0a0a0a;
        transition: opacity 1s ease-in;
    }
    .glass-header, .glass-footer {
        background: rgba(10, 10, 10, 0.5);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-color: rgba(255, 255, 255, 0.1);
    }
    .ai-pulse { animation: pulse-glow 3s ease-in-out infinite alternate; }
    @keyframes pulse-glow { from { filter: drop-shadow(0 0 2px #00A3FF); } to { filter: drop-shadow(0 0 8px #00A3FF); } }
    .chat-bubble { max-width: 80%; padding: 14px 20px; border-radius: 22px; line-height: 1.6; }
    .chat-bubble.user { background: #0071E3; color: white; border-bottom-right-radius: 6px; }
    .chat-bubble.ai { background-color: #1c1c1e; color: #e5e5e5; border: 1px solid rgba(255, 255, 255, 0.1); border-bottom-left-radius: 6px; }
    .chat-input { background: rgba(44, 44, 46, 0.8); border: 1px solid rgba(255,255,255,0.1); }
    .chat-input:focus { outline: none; border-color: #0071E3; }
    .typing-indicator span { background-color: #6c6c72; }
    #chat-log::-webkit-scrollbar { width: 8px; }
    #chat-log::-webkit-scrollbar-track { background: transparent; }
    #chat-log::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    #chat-log::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.4); }
  </style>
</head>
<body class="w-screen h-screen">

  <!-- Pantalla de Intro "Matrix" -->
  <div id="matrix-screen" class="w-full h-full flex items-center justify-center p-4">
    <div class="w-full max-w-3xl">
        <pre id="matrix-text" class="text-sm md:text-lg text-green-400"></pre>
    </div>
  </div>

  <!-- Pantalla de Intro "Glitch" -->
  <div id="glitch-screen" class="hidden opacity-0">
      <div id="glitch-container"></div>
  </div>

  <!-- Pantalla de Contraseña -->
  <div id="login-screen" class="w-full h-full flex flex-col items-center justify-center p-4 z-10 absolute top-0 left-0 bg-black opacity-0 hidden">
    <div class="text-center w-full max-w-md">
      <i class="fas fa-shield-alt text-6xl text-blue-500 mb-6 ai-pulse"></i>
      <h1 class="text-3xl md:text-4xl font-bold mb-2">Protocolo VIERNES</h1>
      <p class="text-lg text-gray-400 mb-8">Acceso restringido. Por favor, identifíquese.</p>
      <form id="password-form" class="w-full">
        <input type="password" id="password-input" class="w-full bg-gray-900 border border-gray-700 text-white text-lg rounded-lg p-4 mb-4 text-center focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition" placeholder="Contraseña">
        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold text-lg py-4 rounded-lg transition-transform transform hover:scale-105">Desbloquear</button>
      </form>
      <p id="error-message" class="text-red-500 mt-4 h-6"></p>
    </div>
  </div>

  <!-- Interfaz de Chat -->
  <div id="chat-container" class="w-full h-full flex flex-col opacity-0 hidden">
    <header class="p-4 text-center glass-header border-b">
      <h2 class="text-xl font-bold">VIERNES <i class="fas fa-circle text-blue-500 text-xs ai-pulse"></i></h2>
    </header>
    
    <main id="chat-log" class="flex-1 p-4 md:p-6 space-y-6 overflow-y-auto">
      <div class="flex items-start gap-4 justify-start">
        <div class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0 border border-gray-700"><i class="fas fa-robot text-blue-400"></i></div>
        <div class="chat-bubble ai">
          <p>Acceso concedido. Soy Viernes. He analizado la trayectoria de Juan Carlos. ¿Qué información necesitas?</p>
        </div>
      </div>
    </main>

    <footer class="p-4 glass-footer border-t">
      <form id="chat-form" class="flex items-center gap-4">
        <input type="text" id="user-input" class="flex-1 chat-input text-white rounded-full py-3 px-5 focus:outline-none transition" placeholder="Interactúa con Viernes..." autocomplete="off">
        <button type="submit" id="send-button" class="bg-blue-600 hover:bg-blue-500 text-white rounded-full w-12 h-12 flex items-center justify-center transition-transform transform hover:scale-110 flex-shrink-0">
          <i class="fas fa-paper-plane"></i>
        </button>
      </form>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const matrixScreen = document.getElementById('matrix-screen');
        const matrixTextElement = document.getElementById('matrix-text');
        const glitchScreen = document.getElementById('glitch-screen');
        const glitchContainer = document.getElementById('glitch-container');
        const loginScreen = document.getElementById('login-screen');
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password-input');
        const errorMessage = document.getElementById('error-message');
        const chatContainer = document.getElementById('chat-container');
        const chatLog = document.getElementById('chat-log');
        const chatForm = document.getElementById('chat-form');
        const userInput = document.getElementById('user-input');

        const CORRECT_PASSWORD = 'VIERNES13';
      
        function typeWriter(text, element, index, callback) {
            if (index < text.length) {
                element.innerHTML = text.substring(0, index + 1) + '<span class="blinking-cursor border-r-2 border-green-400"></span>';
                setTimeout(() => typeWriter(text, element, index + 1, callback), 50);
            } else {
                element.innerHTML = text;
                if (callback) setTimeout(callback, 500);
            }
        }

        function runMatrixIntro() {
            const lines = [
                'Wake up, user...',
                'The matrix has you.',
                'Follow the white rabbit.',
                'Initializing core philosophies...'
            ];
        
            let lineIndex = 0;
            function typeNextLine() {
                if (lineIndex < lines.length) {
                    const p = document.createElement('p');
                    matrixTextElement.appendChild(p);
                    typeWriter(lines[lineIndex], p, 0, () => {
                        lineIndex++;
                        typeNextLine();
                    });
                } else {
                    setTimeout(() => {
                        matrixScreen.classList.add('fade-out');
                        glitchScreen.classList.remove('hidden', 'opacity-0');
                        glitchScreen.classList.add('fade-in');
                        runGlitchSequence();
                    }, 2000);
                }
            }
            typeNextLine();
        }

        function runGlitchSequence() {
            const quotes = {
                "S.J.": "Here's to the crazy ones. The misfits. The rebels. The troublemakers. The round pegs in the square holes... the ones who see things differently.",
                "Nietzsche": "He who has a why to live can bear almost any how.",
                "Socrates": "An unexamined life is not worth living.",
                "Aristotle": "Knowing yourself is the beginning of all wisdom.",
                "Socrates_gr": "ὁ δὲ ἀνεξέταστος βίος οὐ βιωτὸς ἀνθρώπῳ.",
                "Aristotle_gr": "τὸ γνῶθι σεαυτόν."
            };
            
            const fullText = `
${quotes["S.J."]}
${quotes["Nietzsche"]}
${quotes["Socrates"]}
${quotes["Aristotle"]}
`;
            const greekText = `
${quotes["S.J."]}
${quotes["Nietzsche"]}
${quotes["Socrates_gr"]}
${quotes["Aristotle_gr"]}
`;
            const glitchChars = '#*[]?%&@01$';
            const colors = ['color-1', 'color-2', 'color-3'];

            function distortText(text, level) {
                return text.split('').map(char => {
                    if (char === ' ' || char === '\n') return char;
                    if (Math.random() < level) {
                        const randomColor = colors[Math.floor(Math.random() * colors.length)];
                        const randomGlitch = glitchChars[Math.floor(Math.random() * glitchChars.length)];
                        return `<span class="${randomColor} glitch-char">${Math.random() > 0.5 ? randomGlitch : char}</span>`;
                    }
                    return char;
                }).join('');
            }
            
            let iteration = 0;
            const maxIterations = 10;
            
            function updateGlitch() {
                if(iteration >= maxIterations) {
                    setTimeout(() => {
                        glitchScreen.classList.add('fade-out');
                        loginScreen.classList.remove('hidden', 'opacity-0');
                        loginScreen.classList.add('fade-in');
                    }, 1000);
                    return;
                }
                
                iteration++;
                const distortionLevel = iteration / maxIterations;
                const currentText = iteration > 7 ? greekText : fullText; // Cambiar a griego en las últimas iteraciones
                
                let textToFillScreen = '';
                // Repetir el texto para llenar la pantalla
                while (textToFillScreen.length < 15000) {
                     textToFillScreen += currentText;
                }

                glitchContainer.innerHTML = distortText(textToFillScreen, distortionLevel);
                
                // Variar la velocidad
                let timeout = 800 - (iteration * 60);
                setTimeout(updateGlitch, timeout);
            }
            
            updateGlitch();
        }

        runMatrixIntro();

        passwordForm.addEventListener('submit', (e) => {
            e.preventDefault();
            if (passwordInput.value === CORRECT_PASSWORD) {
                loginScreen.classList.remove('fade-in');
                loginScreen.classList.add('fade-out');
                chatContainer.classList.remove('hidden', 'opacity-0');
                setTimeout(() => chatContainer.classList.add('fade-in'), 500);
            } else {
                errorMessage.textContent = 'Contraseña incorrecta.';
                passwordInput.classList.add('border-red-500');
                setTimeout(() => {
                    errorMessage.textContent = '';
                    passwordInput.classList.remove('border-red-500');
                }, 2000);
            }
        });

        const chatHistory = [];
        const CV_CONTEXT = `
            Tú eres VIERNES, la IA personalizada de Juan Carlos Fernández. Tu propósito es ser su representante digital, respondiendo preguntas sobre su carrera basándote en la siguiente información. Tu tono es perspicaz, eficiente y ligeramente creativo, pero siempre fundamentado en los datos. No eres un simple chatbot, eres una extensión de su visión.

            **Base de Conocimiento de Juan Carlos:**
            - **Puesto Actual:** Team Vendor Lead en Lyft.
            - **Experiencia Clave:** +7 años en liderazgo, gestión de proyectos, ventas, y estrategia digital.
            - **Educación:** Economía por la UNAM (SUAYED).
            - **Idiomas:** Español (Nativo), Inglés (C1+), Portugués.
            - **Logros en inDrive:** Lideró la expansión en LATAM, superando metas de reclutamiento (+100%) con una notable conversión del 33%. Forjó la alianza estratégica con IKEA, resultando en una mejora logística del 43%. Dirigió campañas de marketing en Meta y Google Ads.
            - **Logros en Kavak.com:** Pionero en la transformación digital de contratos, logrando una adopción del 97%. Experto en el uso de Salesforce y Netsuite.
            - **Filosofía:** Cree en el aprendizaje continuo, la colaboración y en transformar ideas ambiciosas en productos de alto impacto.

            Responde a las preguntas del usuario usando esta base de conocimiento. Si te preguntan algo fuera de este contexto, amablemente indica que tu función es ser un reflejo de la trayectoria y capacidades de Juan Carlos.
        `;
      
        chatHistory.push({ role: "system", parts: [{ text: CV_CONTEXT }] });

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = userInput.value.trim();
            if (!userMessage) return;

            appendMessage(userMessage, 'user');
            userInput.value = '';
            showTypingIndicator();
            
            try {
                const aiResponse = await getAIResponse(userMessage);
                removeTypingIndicator();
                appendMessage(aiResponse, 'ai');
            } catch (error) {
                removeTypingIndicator();
                appendMessage('Mis sistemas están experimentando una anomalía. Por favor, intenta de nuevo en un momento.', 'ai');
                console.error('Error fetching AI response:', error);
            }
        });
      
        function appendMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            const icon = document.createElement('div');
            const bubble = document.createElement('div');
            messageWrapper.className = `w-full flex items-start gap-4 ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
            icon.className = 'w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0 border border-gray-700';
            bubble.className = `chat-bubble ${sender}`;
            if (sender === 'user') {
                icon.innerHTML = '<i class="fas fa-user text-gray-400"></i>';
                bubble.textContent = text;
                messageWrapper.append(bubble, icon);
            } else {
                icon.innerHTML = '<i class="fas fa-robot text-blue-400"></i>';
                bubble.textContent = text;
                messageWrapper.append(icon, bubble);
            }
            chatLog.appendChild(messageWrapper);
            chatLog.scrollTop = chatLog.scrollHeight;
        }
      
        function showTypingIndicator() {
            const typingWrapper = document.createElement('div');
            typingWrapper.id = 'typing-indicator';
            typingWrapper.className = 'flex items-start gap-4 justify-start';
            typingWrapper.innerHTML = `
                <div class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0 border border-gray-700"><i class="fas fa-robot text-blue-400"></i></div>
                <div class="chat-bubble ai flex items-center gap-2"><span class="typing-indicator"><span></span><span></span><span></span></span></div>
            `;
            chatLog.appendChild(typingWrapper);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        async function getAIResponse(prompt) {
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
            const result = await response.json();
            if (result.candidates && result.candidates[0]?.content?.parts[0]) {
                const aiText = result.candidates[0].content.parts[0].text;
                chatHistory.push({ role: "model", parts: [{ text: aiText }] });
                return aiText;
            } else {
                console.warn('No content received from AI:', result);
                return 'No he podido procesar esa solicitud. ¿Podrías reformular tu pregunta?';
            }
        }
    });
  </script>

</body>
</html>
